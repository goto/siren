"use strict";(self.webpackChunksiren=self.webpackChunksiren||[]).push([[886],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return m}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),c=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(r),m=a,g=d["".concat(s,".").concat(m)]||d[m]||p[m]||i;return r?n.createElement(g,o(o({ref:t},u),{},{components:r})):n.createElement(g,o({ref:t},u))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var c=2;c<i;c++)o[c]=r[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},4730:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return u},default:function(){return d}});var n=r(7462),a=r(3366),i=(r(7294),r(3905)),o=["components"],l={},s="Architecture",c={unversionedId:"concepts/architecture",id:"concepts/architecture",isDocsHomePage:!1,title:"Architecture",description:"Siren exposes HTTP API to allow rule, template and slack & Pagerduty credentials configuration. It talks to upstream",source:"@site/docs/concepts/architecture.md",sourceDirName:"concepts",slug:"/concepts/architecture",permalink:"/siren/docs/concepts/architecture",editUrl:"https://github.com/odpf/siren/edit/master/docs/docs/concepts/architecture.md",tags:[],version:"current",lastUpdatedBy:"Ravi Suhag",lastUpdatedAt:1639651423,formattedLastUpdatedAt:"12/16/2021",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Overview",permalink:"/siren/docs/concepts/overview"},next:{title:"Code Architecture",permalink:"/siren/docs/concepts/code"}},u=[{value:"System Design",id:"system-design",children:[{value:"Technologies",id:"technologies",children:[]},{value:"Components",id:"components",children:[]},{value:"Managing Templates via YAML File",id:"managing-templates-via-yaml-file",children:[]},{value:"Managing Rules via YAML File",id:"managing-rules-via-yaml-file",children:[]}]},{value:"Siren Integration",id:"siren-integration",children:[{value:"Cortex Ruler",id:"cortex-ruler",children:[]},{value:"Cortex Alertmanager",id:"cortex-alertmanager",children:[]}]}],p={toc:u};function d(e){var t=e.components,l=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},p,l,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"architecture"},"Architecture"),(0,i.kt)("p",null,"Siren exposes HTTP API to allow rule, template and slack & Pagerduty credentials configuration. It talks to upstream\ncortex ruler to configure rules(alerting and recording rules). It talks to Cortex Alertmanager to configure the\ndestination where alerts should go. It stores data around credentials, templates and current state of configured alerts\nin PostgresDB. It also stores alerts triggered via Cortex Alertmanager."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Siren Architecture",src:r(8792).Z})),(0,i.kt)("h2",{id:"system-design"},"System Design"),(0,i.kt)("h3",{id:"technologies"},"Technologies"),(0,i.kt)("p",null,"Siren is developed with"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Golang - Programming language"),(0,i.kt)("li",{parentName:"ul"},"Docker - container engine to start postgres and cortex to aid development"),(0,i.kt)("li",{parentName:"ul"},"Cortex - multi-tenant prometheus based monitoring stack"),(0,i.kt)("li",{parentName:"ul"},"Postgres - a relational database")),(0,i.kt)("h3",{id:"components"},"Components"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"HTTP Server"))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"HTTP Server exposes Restful APIs to allow configuration of rules, templates, alerting credentials and storing\ntriggered alert history.")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"PostgresDB"))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Used for storing the templates in a predefined schema enabling reuse of same rule body."),(0,i.kt)("li",{parentName:"ul"},"Stores the rules configured via HTTP APIs and used for preserving thresholds when rule is deleted"),(0,i.kt)("li",{parentName:"ul"},"Stores Slack and Pagerduty credentials to enable DIY interface for configuring destinations for alerting.")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"Command Line Interface"))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Provides a way to manage rules and templates using YAML files in a format described below."),(0,i.kt)("li",{parentName:"ul"},"Run a web-server from CLI."),(0,i.kt)("li",{parentName:"ul"},"Runs DB Migrations")),(0,i.kt)("h3",{id:"managing-templates-via-yaml-file"},"Managing Templates via YAML File"),(0,i.kt)("p",null,"Siren gives flexibility to templatize prometheus rules for re-usability purpose. Template can be managed via HTTP APIs",(0,i.kt)("br",{parentName:"p"}),"\n","at",(0,i.kt)("inlineCode",{parentName:"p"},"/templates")," route in a restful manner. Apart from that, there is a command line interface as well which parses a YAML\nfile in a specified format (as described below) and upload to Siren using an HTTP Client of Siren Service.\nRefer ",(0,i.kt)("a",{parentName:"p",href:"/siren/docs/guides/templates"},"here")," for more details around usage and terminology."),(0,i.kt)("h3",{id:"managing-rules-via-yaml-file"},"Managing Rules via YAML File"),(0,i.kt)("p",null,"To manage rules in bulk, Siren gives a way to manage rules using YAML files, which you can manage in a version\ncontrolled repository. Using the ",(0,i.kt)("inlineCode",{parentName:"p"},"upload")," command one can upload a rule YAML file in a specified format (as described\nbelow) and upload to Siren using an HTTP Client(comes inbuilt) of Siren Service. Refer ",(0,i.kt)("a",{parentName:"p",href:"/siren/docs/guides/rules"},"here")," for\nmore details around usage and terminology."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Note:")," Updating a template also updates the associated rules."),(0,i.kt)("h2",{id:"siren-integration"},"Siren Integration"),(0,i.kt)("p",null,"The section details all integrating systems for Siren deployment. These are external systems that Siren connects to."),(0,i.kt)("h3",{id:"cortex-ruler"},"Cortex Ruler"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The upstream Cortex ruler deployment which is used for rule creation in the proper namespace/group.\nThe ",(0,i.kt)("a",{parentName:"li",href:"/siren/docs/reference/configuration#-cortex.address"},(0,i.kt)("inlineCode",{parentName:"a"},"cortex_host"))," config can be set in Siren.")),(0,i.kt)("h3",{id:"cortex-alertmanager"},"Cortex Alertmanager"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The upstream Cortex alertmanager deployment where slack and pagerduty credentials are stored in the proper format.\nThe ",(0,i.kt)("a",{parentName:"li",href:"/siren/docs/reference/configuration#-cortex.address"},(0,i.kt)("inlineCode",{parentName:"a"},"cortex_host"))," config can be set in Siren.")))}d.isMDXComponent=!0},8792:function(e,t,r){t.Z=r.p+"assets/images/siren-ff8dcd5db93b256e2e45743f85659af0.jpg"}}]);