<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-concepts/notification">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Notification | Siren</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://goto.github.io/siren/docs/concepts/notification"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Notification | Siren"><meta data-rh="true" name="description" content="Notification is one of main features in Siren. Siren capables to send notification to various receivers (Slack, PagerDuty). Notification in Siren could be sent directly to a receiver or user could subscribe notifications by providing key-value label matchers. For the latter, Siren routes notification to specific receivers by matching notification key-value labels with the provided label matchers."><meta data-rh="true" property="og:description" content="Notification is one of main features in Siren. Siren capables to send notification to various receivers (Slack, PagerDuty). Notification in Siren could be sent directly to a receiver or user could subscribe notifications by providing key-value label matchers. For the latter, Siren routes notification to specific receivers by matching notification key-value labels with the provided label matchers."><link data-rh="true" rel="icon" href="/siren/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://goto.github.io/siren/docs/concepts/notification"><link data-rh="true" rel="alternate" href="https://goto.github.io/siren/docs/concepts/notification" hreflang="en"><link data-rh="true" rel="alternate" href="https://goto.github.io/siren/docs/concepts/notification" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EPXDLH6V72"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-EPXDLH6V72",{})</script><link rel="stylesheet" href="/siren/assets/css/styles.5048dbf9.css">
<link rel="preload" href="/siren/assets/js/runtime~main.513baa05.js" as="script">
<link rel="preload" href="/siren/assets/js/main.4b0fb9c2.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#222;color:#eee" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like Siren, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/goto/siren">GitHub</a>! ⭐</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/siren/"><div class="navbar__logo"><img src="/siren/img/logo.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/siren/img/logo.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Siren</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/siren/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/siren/docs/support">Support</a><a href="https://bit.ly/2RzPbtn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-slack-link"></a><a href="https://github.com/goto/siren" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-item-github"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/siren/"><img src="/siren/img/logo.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/siren/img/logo.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU"><b>Siren</b></a><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siren/docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siren/docs/use_cases">Use Cases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siren/docs/installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/siren/docs/tour/introduction">Tour</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/siren/docs/concepts/overview">Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siren/docs/concepts/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siren/docs/concepts/plugin">Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/siren/docs/concepts/notification">Notification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siren/docs/concepts/glossary">Glossary</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/siren/docs/guides/overview">Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/siren/docs/providers/cortexmetrics">Providers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/siren/docs/receivers/slack">Receivers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/siren/docs/reference/api">Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/siren/docs/extend/adding_new_provider">Extend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/siren/docs/contribute/contribution">Contribute</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Notification</h1><p>Notification is one of main features in Siren. Siren capables to send notification to various receivers (Slack, PagerDuty). Notification in Siren could be sent directly to a receiver or user could subscribe notifications by providing key-value label matchers. For the latter, Siren routes notification to specific receivers by matching notification key-value labels with the provided label matchers.</p><p>Below is how the notification is implemented in Siren</p><p><img loading="lazy" alt="Notification in Siren" src="/siren/assets/images/siren_notification-1a3e9ba1f0e300d62328dc681a9b77bf.svg" width="2337" height="324" class="img_ev3q"></p><p><strong>Notification Source</strong> is a point where a notification is generated. In Siren, there are two points of notification source: <code>/receivers/{id}/send</code> API and alerts hook API. The first one will generate and publish notification when the API is invoked with some message in its payload and the latter one will always generate and publish notification everytime the hook API is called by the provider.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="notification-message">Notification Message<a class="hash-link" href="#notification-message" title="Direct link to heading">​</a></h2><p>Each receiver might expect different payload. User needs to pass notification message payload in the same format as what receiver (notification vendor) expected. All message payload contracts could be found under <a href="/siren/docs/receivers/slack">receivers</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="templating-notification-message-payload">Templating Notification Message Payload<a class="hash-link" href="#templating-notification-message-payload" title="Direct link to heading">​</a></h3><p>Message payload in notification could also be reused by defining template and passing some variables needed. See <a href="/siren/docs/guides/template">template</a> for further details on how to use the template feature.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="notification-message-state">Notification Message State<a class="hash-link" href="#notification-message-state" title="Direct link to heading">​</a></h3><p>There are several possible states of notification message when Siren tries to send it.</p><ul><li><code>enqueued</code> means notification message has been just enqueued. This is a fresh notification message that is ready to be dequeued.</li><li><code>pending</code> means the notification message is dequeued and the process of sending notification is still on-going.</li><li><code>failed</code> means there is something wrong when Siren tried to send the notification. The <code>last error</code> and <code>number of attempt</code> are recorded in the message itself.</li><li><code>published</code> means the message has successfully been sent.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="notification-message-expiry-duration">Notification Message Expiry Duration<a class="hash-link" href="#notification-message-expiry-duration" title="Direct link to heading">​</a></h3><p>It is possible to set notification message to be expired after some duration. If the expiry duration is not set, this assumes the notification message has no expiration time.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="queue">Queue<a class="hash-link" href="#queue" title="Direct link to heading">​</a></h2><p>Queue is used as a buffer to avoid pressure when notifications are being sent. Siren implements Queue as a plugin. Currently there are two kind of queue plugin supported: in-memory (not for production usage) and postgres. User could choose the which queue to use by mentioning it in the <a href="/siren/docs/reference/server_configuration">config</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="in-memory-queue">In-memory Queue<a class="hash-link" href="#in-memory-queue" title="Direct link to heading">​</a></h3><p>In-memory queue simulates a queue with Go channel. The usage is intended to be used in development only.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="postgresql-queue">PostgreSQL Queue<a class="hash-link" href="#postgresql-queue" title="Direct link to heading">​</a></h3><p>Siren uses Postgres <code>SKIP LOCK</code> feature to implement queues with postgres.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="notification-handlers">Notification Handlers<a class="hash-link" href="#notification-handlers" title="Direct link to heading">​</a></h2><p>Notification handler responsibles to dequeue message and send notification to the receivers. There are two kind of Notification Handler in Siren, the main notification handler and the notification dlq handler. Both could be configured in the <a href="/siren/docs/reference/server_configuration">server configuration</a>.</p><p>Notification handlers could be run in the same process inside server or could be run separately as a <a href="/siren/docs/guides/workers">worker</a>. It is also possible for the handlers to only process specific receiver types. This can be done by specifying supported <code>receiver_types</code> in the <a href="/siren/docs/reference/server_configuration">config</a>. One could also configure the notification to be dequeued in batch by specifying <code>batch_size &gt; 1</code> in the config.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="notification-message-handler">Notification Message Handler<a class="hash-link" href="#notification-message-handler" title="Direct link to heading">​</a></h3><p>The notification message handler is a main handler that will dequeue the supported <code>receiver_type</code> with <code>batch_size</code> number messages that are not expired from the main queue and try sending each message to the desired receivers. </p><p>If there is an error, main notification handler will clasify whether the error is retryable or not (e.g. if bad request, it is non-retryable), mark the message as <code>failed</code> and queue it to DLQ.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="notification-dlq-handler">Notification DLQ handler<a class="hash-link" href="#notification-dlq-handler" title="Direct link to heading">​</a></h3><p>The notification dlq handler will dequeue the supported <code>receiver_type</code> with <code>batch_size</code> number messages that are not expired and have <code>failed</code> status from the dlq and try sending each message to the desired receivers. If there is an error, dlq handler will clasify whether the error is retryable or not. Notification handler will re-pick up the <code>failed</code> messages that are retryable and has been retried less than or equal max tries config.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/goto/siren/edit/master/docs/docs/concepts/notification.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/siren/docs/concepts/plugin"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Plugin</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/siren/docs/concepts/glossary"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Glossary</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#notification-message" class="table-of-contents__link toc-highlight">Notification Message</a><ul><li><a href="#templating-notification-message-payload" class="table-of-contents__link toc-highlight">Templating Notification Message Payload</a></li><li><a href="#notification-message-state" class="table-of-contents__link toc-highlight">Notification Message State</a></li><li><a href="#notification-message-expiry-duration" class="table-of-contents__link toc-highlight">Notification Message Expiry Duration</a></li></ul></li><li><a href="#queue" class="table-of-contents__link toc-highlight">Queue</a><ul><li><a href="#in-memory-queue" class="table-of-contents__link toc-highlight">In-memory Queue</a></li><li><a href="#postgresql-queue" class="table-of-contents__link toc-highlight">PostgreSQL Queue</a></li></ul></li><li><a href="#notification-handlers" class="table-of-contents__link toc-highlight">Notification Handlers</a><ul><li><a href="#notification-message-handler" class="table-of-contents__link toc-highlight">Notification Message Handler</a></li><li><a href="#notification-dlq-handler" class="table-of-contents__link toc-highlight">Notification DLQ handler</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"></div></footer></div>
<script src="/siren/assets/js/runtime~main.513baa05.js"></script>
<script src="/siren/assets/js/main.4b0fb9c2.js"></script>
</body>
</html>