(self.webpackChunksiren=self.webpackChunksiren||[]).push([[710],{1410:function(e,t,a){const n=a(7694),r=a(3618);e.exports={title:"Siren",tagline:"Universal data observability toolkit",url:"https://odpf.github.io",baseUrl:"/siren/",onBrokenLinks:"throw",onBrokenMarkdownLinks:"warn",favicon:"img/favicon.ico",organizationName:"odpf",projectName:"siren",customFields:{apiVersion:"v1beta1",defaultHost:"http://localhost:8080"},presets:[["@docusaurus/preset-classic",{docs:{sidebarPath:6679,editUrl:"https://github.com/odpf/siren/edit/master/docs/",sidebarCollapsed:!0,breadcrumbs:!1},blog:!1,theme:{customCss:[5308,2295]},gtag:{trackingID:"G-EPXDLH6V72"}}]],themeConfig:{colorMode:{defaultMode:"light",respectPrefersColorScheme:!0},navbar:{title:"Siren",logo:{src:"img/logo.svg"},hideOnScroll:!0,items:[{type:"doc",docId:"introduction",position:"right",label:"Docs"},{to:"docs/support",label:"Support",position:"right"},{href:"https://bit.ly/2RzPbtn",position:"right",className:"header-slack-link"},{href:"https://github.com/odpf/siren",className:"navbar-item-github",position:"right"}]},footer:{style:"light",links:[]},prism:{theme:n,darkTheme:r},announcementBar:{id:"star-repo",content:'\u2b50\ufe0f If you like Siren, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/odpf/siren">GitHub</a>! \u2b50',backgroundColor:"#222",textColor:"#eee",isCloseable:!0}}}},5162:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var n=a(7294),r=a(4334),i="tabItem_Ymn6";function o(e){let{children:t,hidden:a,className:o}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(i,o),hidden:a},t)}},5488:function(e,t,a){"use strict";a.d(t,{Z:function(){return m}});var n=a(3117),r=a(7294),i=a(4334),o=a(2389),l=a(7392),s=a(7094),c=a(2466),u="tabList__CuJ",p="tabItem_LNqP";function d(e){var t;const{lazy:a,block:o,defaultValue:d,values:m,groupId:g,className:f}=e,h=r.Children.map(e.children,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),k=m??h.map((e=>{let{props:{value:t,label:a,attributes:n}}=e;return{value:t,label:a,attributes:n}})),y=(0,l.l)(k,((e,t)=>e.value===t.value));if(y.length>0)throw new Error(`Docusaurus error: Duplicate values "${y.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const v=null===d?d:d??(null==(t=h.find((e=>e.props.default)))?void 0:t.props.value)??h[0].props.value;if(null!==v&&!k.some((e=>e.value===v)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${v}" but none of its children has the corresponding value. Available values are: ${k.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:b,setTabGroupChoices:N}=(0,s.U)(),[C,w]=(0,r.useState)(v),_=[],{blockElementScrollPositionUntilNextRender:T}=(0,c.o5)();if(null!=g){const e=b[g];null!=e&&e!==C&&k.some((t=>t.value===e))&&w(e)}const P=e=>{const t=e.currentTarget,a=_.indexOf(t),n=k[a].value;n!==C&&(T(t),w(n),null!=g&&N(g,String(n)))},S=e=>{var t;let a=null;switch(e.key){case"ArrowRight":{const t=_.indexOf(e.currentTarget)+1;a=_[t]??_[0];break}case"ArrowLeft":{const t=_.indexOf(e.currentTarget)-1;a=_[t]??_[_.length-1];break}}null==(t=a)||t.focus()};return r.createElement("div",{className:(0,i.Z)("tabs-container",u)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":o},f)},k.map((e=>{let{value:t,label:a,attributes:o}=e;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:C===t?0:-1,"aria-selected":C===t,key:t,ref:e=>_.push(e),onKeyDown:S,onFocus:P,onClick:P},o,{className:(0,i.Z)("tabs__item",p,null==o?void 0:o.className,{"tabs__item--active":C===t})}),a??t)}))),a?(0,r.cloneElement)(h.filter((e=>e.props.value===C))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},h.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==C})))))}function m(e){const t=(0,o.Z)();return r.createElement(d,(0,n.Z)({key:String(t)},e))}},6679:function(e){e.exports={docsSidebar:["introduction",{type:"category",label:"Tour",items:["tour/introduction","tour/startup_siren_server","tour/registering_provider","tour/registering_receivers","tour/sending_notifications_to_receiver","tour/configuring_provider_alerting_rules","tour/subscribing_notifications"]},{type:"category",label:"Concepts",items:["concepts/overview","concepts/plugin","concepts/schema"]},{type:"category",label:"Guides",items:["guides/overview","guides/provider_and_namespace","guides/receiver","guides/subscription","guides/rule","guides/template","guides/alert_history","guides/notification","guides/deployment"]},{type:"category",label:"Contribute",items:["contribute/contribution","contribute/receiver","contribute/provider","contribute/release"]},{type:"category",label:"Reference",items:["reference/api","reference/server_configuration","reference/client_configuration","reference/receiver","reference/cli"]}]}},6531:function(e,t,a){"use strict";a.r(t),a.d(t,{apiVersion:function(){return f},assets:function(){return m},contentTitle:function(){return p},default:function(){return y},defaultHost:function(){return h},frontMatter:function(){return u},metadata:function(){return d},toc:function(){return g}});var n=a(3117),r=(a(7294),a(3905)),i=a(5488),o=a(5162),l=a(6066),s=a(1410),c=a.n(s);const u={},p="Receiver",d={unversionedId:"reference/receiver",id:"reference/receiver",title:"Receiver",description:"Receiver represents a notification medium, which can be used to define notification routing configuration in Siren. Siren currently supports several type of receivers. Here is receiver schema. The type of stored receiver in the DB is immutable.",source:"@site/docs/reference/receiver.md",sourceDirName:"reference",slug:"/reference/receiver",permalink:"/siren/docs/reference/receiver",draft:!1,editUrl:"https://github.com/odpf/siren/edit/master/docs/docs/reference/receiver.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Client Configuration",permalink:"/siren/docs/reference/client_configuration"},next:{title:"CLI",permalink:"/siren/docs/reference/cli"}},m={},g=[{value:"Slack",id:"slack",level:2},{value:"Configurations in API",id:"configurations-in-api",level:3},{value:"Configurations Stored in DB",id:"configurations-stored-in-db",level:3},{value:"Message Payload Format",id:"message-payload-format",level:3},{value:"Message Payload Templating",id:"message-payload-templating",level:3},{value:"PagerDuty",id:"pagerduty",level:2},{value:"Configurations in API",id:"configurations-in-api-1",level:3},{value:"Message Payload Format",id:"message-payload-format-1",level:3},{value:"Message Payload Templating",id:"message-payload-templating-1",level:3},{value:"HTTP",id:"http",level:2},{value:"Configurations in API",id:"configurations-in-api-2",level:3},{value:"Message Payload Format",id:"message-payload-format-2",level:3},{value:"File",id:"file",level:2},{value:"Configurations in API",id:"configurations-in-api-3",level:3},{value:"Message Payload Format",id:"message-payload-format-3",level:3}],f=c().customFields.apiVersion,h=c().customFields.defaultHost,k={toc:g,apiVersion:f};function y(e){let{components:t,...s}=e;return(0,r.kt)("wrapper",(0,n.Z)({},k,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"receiver"},"Receiver"),(0,r.kt)("p",null,"Receiver represents a notification medium, which can be used to define notification routing configuration in Siren. Siren currently supports several type of receivers. Here is receiver ",(0,r.kt)("a",{parentName:"p",href:"/siren/docs/concepts/schema#receivers"},"schema"),". The ",(0,r.kt)("inlineCode",{parentName:"p"},"type")," of stored receiver in the DB is immutable."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#slack"},"Slack")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#pagerduty"},"PagerDuty")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#http"},"HTTP")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#file"},"File"))),(0,r.kt)("p",null,"Configuration of each receiver depends on the type itself. This page describes all configurations for various receivers that Siren supports."),(0,r.kt)("h2",{id:"slack"},"Slack"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Type: slack")),(0,r.kt)("h3",{id:"configurations-in-api"},"Configurations in API"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'"configurations": {\n    "client_id": <string>\n    "client_secret": <string>,\n    "auth_code": <string>\n}\n')),(0,r.kt)("h3",{id:"configurations-stored-in-db"},"Configurations Stored in DB"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'"configurations": {\n    "token": <encrypted string>\n}\n')),(0,r.kt)("p",null,"Creating a slack receiver involves exchanging the auth code for a token with slack oAuth server. Siren will need the auth code, client id, client secret and optional label metadata."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example")),(0,r.kt)(i.Z,{groupId:"api",mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"cli",label:"CLI",default:!0,mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ siren receiver create --file slack_receiver.yaml\n"))),(0,r.kt)(o.Z,{value:"http",label:"HTTP",mdxType:"TabItem"},(0,r.kt)(l.Z,{className:"language-bash",mdxType:"CodeBlock"},"$ curl --request POST\n  --url ",h,"/",f,'/receivers\n  --header \'content-type: application/json\'\n  --data-raw \'{\n    "name": "doc-slack-receiver",\n    "type": "slack",\n    "labels": {\n        "team": "siren-devs"\n    },\n    "configurations": {\n        "client_id": "abcd",\n        "client_secret": "xyz",\n        "auth_code": "123"\n    }\n}\''))),(0,r.kt)("p",null,"On success, this will store the encrypted app token for that particular slack workspace and use it for sending out notifications."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Permissions and Auth Settings for Slack Receivers")),(0,r.kt)("p",null,"In order to send Slack notifications via Siren API, you need to create its receiver. This Slack app then must be\ninstalled in the required workspaces and added to the required channels."),(0,r.kt)("p",null,"Siren helps with the installation flow by automating the exchanging code for access token\nflow. ",(0,r.kt)("a",{parentName:"p",href:"https://api.slack.com/legacy/oauth#authenticating-users-with-oauth__the-oauth-flow"},"Reference"),"."),(0,r.kt)("p",null,"Here is the list of actions one need to take to attach a Slack app to Siren."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Create a Slack app with these permissions. Visit ",(0,r.kt)("a",{parentName:"p",href:"https://api.slack.com/apps"},"this"),". If you already have an app, make\nsure permissions mentioned below are there.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Configure these permissions in the app:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-text"}," channels:read\n chat:write\n groups:read\n im:read\n team:read\n users:read\n users:read.email\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Enable Distribution")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Setup a redirection server. You can use localhost as well. This must be a https server. Slack will call this server\nonce we install the app in any workspace.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Install your app to a workspace. Visit ",(0,r.kt)("inlineCode",{parentName:"p"},"Manage Distribution")," section on the App Dashboard. Click the ",(0,r.kt)("inlineCode",{parentName:"p"},"Add to Slack")," Button.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"This will prompt you to the OAuth Consent screen. Make sure you have selected the correct Slack Workspace by\nverifying the dropdown in the top-right corner. Click Allow.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy the ",(0,r.kt)("inlineCode",{parentName:"p"},"code")," that you received from Slack redirection URL query params and use this inside create receiver payload."))),(0,r.kt)("h3",{id:"message-payload-format"},"Message Payload Format"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"channel: <string>\ntext: <string>\nusername: <string>\nicon_emoji: <string>\nicon_url: <string>\nlink_names: <boolean>\nattachments:\n  - <key1>: <any>\n    <key2>: <any>\n  - <key3>: <any>\n    <key4>: <any>\n    .\n    .\n")),(0,r.kt)("p",null,"Payload format above follow ",(0,r.kt)("a",{parentName:"p",href:"https://api.slack.com/methods/chat.postMessage"},"slack chat.postMessage API")," contract."),(0,r.kt)("p",null,"Using a slack receiver you will be able to send out Slack notification using its send API. You can also use it to route alerts using Subscriptions whenever an alert matches the conditions of your choice. Check the required permissions of the Slack App ",(0,r.kt)("a",{parentName:"p",href:"/siren/docs/reference/receiver#permissions-and-auth-settings-for-slack-receivers"},"here"),"."),(0,r.kt)("h3",{id:"message-payload-templating"},"Message Payload Templating"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Cortex Alert Template")),(0,r.kt)("p",null,"Siren has a slack default ",(0,r.kt)("a",{target:"_blank",href:a(5138).Z},"template")," for all notifications generated by Cortex Alert."),(0,r.kt)("h2",{id:"pagerduty"},"PagerDuty"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Type: pagerduty")),(0,r.kt)("h3",{id:"configurations-in-api-1"},"Configurations in API"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'"configurations": {\n    "service_key": <string>\n}\n')),(0,r.kt)("h3",{id:"message-payload-format-1"},"Message Payload Format"),(0,r.kt)("p",null,"Pagerduty has v1 and v2 events API. What Siren's support currently is sending event to PagerDuty events v1 API."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"# v1\nservice_key: <string>\nevent_type: <string>\nincident_key: <string>\ndescription: <string>\nclient: <string>\nclient_url: <string>\ndetails:\n  - <key1>: <any>\n    <key2>: <any>\n  - <key3>: <any>\n    <key4>: <any>\n    .\n    .\ncontexts:\n  - type:  <string>\n    src:  <string>\n    href:  <string>\n    text:  <string>\n    alt:  <string>\n  - type:  <string>\n    src:  <string>\n    href:  <string>\n    text:  <string>\n    alt:  <string>\n    .\n    .\n")),(0,r.kt)("h3",{id:"message-payload-templating-1"},"Message Payload Templating"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Cortex Alert Template")),(0,r.kt)("p",null,"Siren has a PagerDuty default ",(0,r.kt)("a",{target:"_blank",href:a(1084).Z},"template")," for all notifications generated by Cortex Alert."),(0,r.kt)("h2",{id:"http"},"HTTP"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Type: http")),(0,r.kt)("h3",{id:"configurations-in-api-2"},"Configurations in API"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'"configurations": {\n  "url": <string>\n}\n')),(0,r.kt)("h3",{id:"message-payload-format-2"},"Message Payload Format"),(0,r.kt)("p",null,"Payload will be sent as-is. If defined by ",(0,r.kt)("a",{parentName:"p",href:"/siren/docs/guides/template"},"templates"),", payload will be the same with the generated payload by template."),(0,r.kt)("h2",{id:"file"},"File"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Type: file")),(0,r.kt)("p",null,"File receiver write down outgoing notifications to a file located with an ",(0,r.kt)("inlineCode",{parentName:"p"},"url")," in the configurations."),(0,r.kt)("h3",{id:"configurations-in-api-3"},"Configurations in API"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"url")," below should be file path url e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"./folder_a/folder_b/file.json"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'"configurations": {\n  "url": <string>\n}\n')),(0,r.kt)("h3",{id:"message-payload-format-3"},"Message Payload Format"),(0,r.kt)("p",null,"Payload will be written to file as-is in ",(0,r.kt)("inlineCode",{parentName:"p"},"ndjson")," format."))}y.isMDXComponent=!0},1084:function(e,t,a){"use strict";t.Z=a.p+"assets/files/default_cortex_alert_template_body_v1-52f7f2ea1c79d472e80dd60599cb0abc.goyaml"},5138:function(e,t,a){"use strict";t.Z=a.p+"assets/files/default_cortex_alert_template_body-401540691e207d03b4ef74f3b883b1f6.goyaml"},3618:function(e,t,a){"use strict";a.r(t);t.default={plain:{color:"#F8F8F2",backgroundColor:"#282A36"},styles:[{types:["prolog","constant","builtin"],style:{color:"rgb(189, 147, 249)"}},{types:["inserted","function"],style:{color:"rgb(80, 250, 123)"}},{types:["deleted"],style:{color:"rgb(255, 85, 85)"}},{types:["changed"],style:{color:"rgb(255, 184, 108)"}},{types:["punctuation","symbol"],style:{color:"rgb(248, 248, 242)"}},{types:["string","char","tag","selector"],style:{color:"rgb(255, 121, 198)"}},{types:["keyword","variable"],style:{color:"rgb(189, 147, 249)",fontStyle:"italic"}},{types:["comment"],style:{color:"rgb(98, 114, 164)"}},{types:["attr-name"],style:{color:"rgb(241, 250, 140)"}}]}},7694:function(e,t,a){"use strict";a.r(t);t.default={plain:{color:"#393A34",backgroundColor:"#f6f8fa"},styles:[{types:["comment","prolog","doctype","cdata"],style:{color:"#999988",fontStyle:"italic"}},{types:["namespace"],style:{opacity:.7}},{types:["string","attr-value"],style:{color:"#e3116c"}},{types:["punctuation","operator"],style:{color:"#393A34"}},{types:["entity","url","symbol","number","boolean","variable","constant","property","regex","inserted"],style:{color:"#36acaa"}},{types:["atrule","keyword","attr-name","selector"],style:{color:"#00a4db"}},{types:["function","deleted","tag"],style:{color:"#d73a49"}},{types:["function-variable"],style:{color:"#6f42c1"}},{types:["tag","selector","keyword"],style:{color:"#00009f"}}]}}}]);